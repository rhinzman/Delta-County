<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta County GIS App</title>

    <!-- ArcGIS API for JavaScript CSS -->
    <link rel="stylesheet" href="https://js.arcgis.com/4.25/esri/themes/light/main.css">
    <link rel="stylesheet" href="styles.css">

    <!-- ArcGIS API for JavaScript -->
    <script src="https://js.arcgis.com/4.25/"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Delta County GIS Application</h1>
            <p>Interactive map of Delta County, Michigan</p>
        </div>
    </header>
    
    <main>
        <div id="map-container">
            <!-- viewDiv is required by the ArcGIS API for JavaScript MapView -->
            <div id="viewDiv"></div>
        </div>
        
        <!-- Field Collection Button -->
        <a href="https://fieldmaps.arcgis.app/?itemID=4276a0e0d3c945bb821df31742b254de&referenceContext=open&portalURL=https%3A%2F%2Fuw-mad.maps.arcgis.com" 
           target="_blank"
           class="field-collection-btn" 
           title="Open Field Collection App">
            ðŸ“± Field Collection
        </a>

        <script>
            require(["esri/config", "esri/WebMap", "esri/views/MapView"], function(esriConfig, WebMap, MapView) {
                // set api key
                esriConfig.apiKey = "AAPKd744f2fda2e347d9a3cf7faf3473cfaczN_o6-pVEC0xDG9THThI-plcBTYdOZQwfAaWLFCk-7w8cNq-B8MvENgmb2NpNTXc";
                // set portal URL since it's not the default ArcGIS Online
                esriConfig.portalUrl = "https://uw-mad.maps.arcgis.com";

                // create a WebMap from the portal item id
                const webmap = new WebMap({
                    portalItem: {
                        id: "https://uw-mad.maps.arcgis.com/home/item.html?id=18855e2cb43a4c7aa6212f1692b35d7d" // the map to load
                    }
                });

                const view = new MapView({
                    container: "viewDiv",
                    map: webmap
                });

                view.when(() => {
                    console.log('WebMap loaded:', webmap.portalItem.title);
                }, function(error){
                    console.error('View or WebMap failed to load:', error);
                });
            });

            // Ensure the button opens in a new tab if JS is enabled
            const fcBtn = document.querySelector('.field-collection-btn');
            if (fcBtn) fcBtn.addEventListener('click', function(event) {
                event.preventDefault();
                window.open(this.href, '_blank');
            });
        </script>
    </main>
    
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Delta County GIS Application | Data from Delta County, Michigan</p>
        </div>
    </footer>
    
</body>
</html>
